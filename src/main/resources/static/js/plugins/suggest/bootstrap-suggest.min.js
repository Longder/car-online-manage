/**
 * bootstrap-suggest-plugin - v0.1.21
 * @description 这是一个基于 bootstrap 按钮式下拉菜单组件的搜索建议插件，必须使用于按钮式下拉菜单组件上。
 * @author [object Object]
 * @GitHub https://github.com/lzwme/bootstrap-suggest-plugin.git
 * @since 2017-09-14 15:22:49
 */

!function(t){if("function"==typeof define&&define.amd)define(["jquery"],t);else if("object"==typeof exports&&"object"==typeof module)t(require("jquery"));else{if(!window.jQuery)throw new Error("Not found jQuery.");t(window.jQuery)}}(function(t){function e(t,e){window.console&&window.console.trace}function n(t){return t.data()}function i(t,e){return void 0!==e?t.attr("alt",e):t.attr("alt")}function o(t,e){return void 0!==e?t.attr("data-id",e):t.attr("data-id")}function r(t,e,n){if(e&&e.key){var i,r,a=n.separator||",",s=o(t);n&&n.multiWord?((i=t.val().split(a))[i.length-1]=e.key,s?(r=s.split(a)).push(e.id):r=[e.id],o(t,r.join(a)).val(i.join(a)).focus()):o(t,e.id||"").val(e.key).focus(),t.trigger("onSetSelectValue",[e,(n.data.value||n._lastData.value)[e.index]])}}function a(t,e,n){if(e.is(":visible")){var i=t.parent(),o=i.height(),r=i.width();n.autoDropup&&setTimeout(function(){var n=t.offset().top,o=w.scrollTop(),r=e.height();w.height()+o-n<r&&n>r+o?i.addClass("dropup"):i.removeClass("dropup")},10);var a={};return"left"===n.listAlign?a={left:t.siblings("div").width()-r,right:"auto"}:"right"===n.listAlign&&(a={left:"auto",right:0}),x&&!n.showBtn&&(i.hasClass("dropup")?(a.top="auto",a.bottom=o):(a.top=o,a.bottom="auto")),n.autoMinWidth||(a.minWidth=r),e.css(a),t}}function s(t,e){var n,i,r;return-1===e.indexId&&!e.idField||e.multiWord?t:(n=t.css("backgroundColor").replace(/ /g,"").split(",",3).join(","),i=e.inputBgColor||"rgba(255,255,255,0.1)",r=e.inputWarnColor||"rgba(255,255,0,0.1)",o(t)||!t.val()?t.css("background",i):(~r.indexOf(n)||t.trigger("onUnsetSelectValue").css("background",r),t))}function l(t,e,n){var i,o,r=t.parent().find("tbody tr."+n.listHoverCSS);r.length&&((i=(r.index()+3)*r.height())>(o=+e.css("maxHeight").replace("px",""))||e.scrollTop()>o?i-=o:i=0,e.scrollTop(i))}function u(t,e){t.find("tr."+e.listHoverCSS).removeClass(e.listHoverCSS)}function d(t,e,n){return!e.length||t.data(j)?A:(t.data(j,{options:n}),D)}function f(t){var n,i=D;for(n in t)if("value"===n){i=A;break}return i?(e("返回数据格式错误!"),A):t.value.length?t:A}function c(e,n){var i=n.effectiveFields;return!("__index"===e||i.length&&!~t.inArray(e,i))}function p(e,n){return~t.inArray(e,n.searchFields)}function h(t,e,n,i){n.html('<div style="padding:10px 5px 5px">'+t+"</div>").show(),a(e,n,i)}function v(t,e,n){var i,o,r,s,l,u,d=t.parent().find("ul:eq(0)"),f=0,p=['<table class="table table-condensed table-sm" style="margin:0">'],v=e.value;if(!e||!(i=v.length))return n.emptyTip?h(n.emptyTip,t,d,n):d.empty().hide(),t;if(n._lastData&&JSON.stringify(n._lastData)===JSON.stringify(e)&&d.find("tr").length===i)return d.show(),a(t,d,n);if(n._lastData=e,n.showHeader){p.push("<thead><tr>");for(r in v[0])c(r,n)&&(p.push("<th>",n.effectiveFieldsAlias[r]||r,0===f?"("+i+")":"","</th>"),f++);p.push("</tr></thead>")}p.push("<tbody>");var y;for(o=0;o<i;o++){f=0,s=[],l=(y=v[o])[n.idField]||"",u=y[n.keyField]||"";for(r in y)u||n.indexKey!==f||(u=y[r]),l||n.indexId!==f||(l=y[r]),f++,c(r,n)&&s.push('<td data-name="',r,'">',y[r],"</td>");p.push('<tr data-index="',y.__index||o,'" data-id="',l,'" data-key="',u,'">',s.join(""),"</tr>")}return p.push("</tbody></table>"),d.html(p.join("")).show(),setTimeout(function(){if(!S){var t=d.find("table:eq(0)"),e=0,n=0;d.height()<t.height()&&+d.css("minWidth").replace("px","")<d.width()&&(e=18,n=20),d.css("paddingRight",e),t.css("marginBottom",n)}},301),a(t,d,n),t}function y(e,n){n=n||"";var i=e._preAjax;i&&i.abort&&4!==i.readyState&&i.abort();var o={type:"GET",dataType:e.jsonp?"jsonp":"json",timeout:5e3};e.jsonp&&(o.jsonp=e.jsonp);var r,a=e.fnAdjustAjaxParam;if(t.isFunction(a)){if(r=a(n,e),A===r)return;t.extend(o,r)}return o.url=function(){if(!n||o.data)return o.url||e.url;var t="?";return/=$/.test(e.url)?t="":/\?/.test(e.url)&&(t="&"),e.url+t+encodeURIComponent(n)}(),e._preAjax=t.ajax(o).done(function(t){e.data=e.fnProcessData(t)}).fail(function(t){e.fnAjaxFail&&e.fnAjaxFail(t,e)})}function g(e,n,i,o){return i=t.trim(i),o.ignorecase&&(e=e.toLocaleLowerCase(),i=i.toLocaleLowerCase()),i&&(c(n,o)||p(n,o))&&(~i.indexOf(e)||o.twoWayMatch&&~e.indexOf(i))}function b(e,n){var i=e.prev("i.clearable");return n.clearable&&!i.length&&(i=t('<i class="clearable glyphicon glyphicon-remove"></i>').prependTo(e.parent())),i.css({position:"absolute",top:12,right:n.showBtn?(e.next(".input-group-btn").width()||33)+2:12,zIndex:4,cursor:"pointer",fontSize:12}).hide()}var m,w=t(window),x="ActiveXObject"in window,k=navigator.userAgent.match(/Chrome\/(\d+)/);k&&(k=+k[1]);var S=x||k>51,j="bsSuggest",C="onDataRequestSuccess",D=!0,A=!1,F={url:null,jsonp:null,data:{value:[]},indexId:0,indexKey:0,idField:"",keyField:"",autoSelect:D,allowNoKeyword:D,getDataMethod:"firstByUrl",delayUntilKeyup:A,ignorecase:A,effectiveFields:[],effectiveFieldsAlias:{},searchFields:[],twoWayMatch:D,multiWord:A,separator:",",delay:300,emptyTip:"",searchingTip:"搜索中...",autoDropup:A,autoMinWidth:A,showHeader:A,showBtn:D,inputBgColor:"",inputWarnColor:"rgba(255,0,0,.1)",listStyle:{"padding-top":0,"max-height":"375px","max-width":"800px",overflow:"auto",width:"auto",transition:"0.3s","-webkit-transition":"0.3s","-moz-transition":"0.3s","-o-transition":"0.3s"},listAlign:"left",listHoverStyle:"background: #07d; color:#fff",listHoverCSS:"jhover",clearable:A,keyLeft:37,keyUp:38,keyRight:39,keyDown:40,keyEnter:13,fnProcessData:function(t){return f(t)},fnGetData:function(e,n,i,o){var r,a,s,l,u={value:[]},d=o.fnPreprocessKeyword;if(e=e||"",t.isFunction(d)&&(e=d(e,o)),o.url){var c;o.searchingTip&&(c=setTimeout(function(){h(o.searchingTip,n,n.parent().find("ul"),o)},600)),y(o,e).done(function(t){i(n,o.data,o),n.trigger(C,t),"firstByUrl"===o.getDataMethod&&(o.url=null)}).always(function(){c&&clearTimeout(c)})}else{if(r=o.data,f(r))if(e){for(l=r.value.length,a=0;a<l;a++)for(s in r.value[a])if(r.value[a][s]&&g(e,s,r.value[a][s]+"",o)){u.value.push(r.value[a]),u.value[u.value.length-1].__index=a;break}}else u=r;i(n,u,o)}},fnAdjustAjaxParam:null,fnPreprocessKeyword:null,fnAjaxFail:null},T={init:function(e){var f=this;return void 0===(e=e||{}).showHeader&&e.effectiveFields&&e.effectiveFields.length>1&&(e.showHeader=D),(e=t.extend(D,{},F,e)).processData&&(e.fnProcessData=e.processData),e.getData&&(e.fnGetData=e.getData),"firstByUrl"===e.getDataMethod&&e.url&&!e.delayUntilKeyup&&y(e).done(function(t){e.url=null,f.trigger(C,t)}),t("#"+j).length||t("head:eq(0)").append('<style id="'+j+'">.'+e.listHoverCSS+"{"+e.listHoverStyle+"}</style>"),f.each(function(){var f,c,p=t(this),h=p.parent(),y=b(p,e),g=h.find("ul:eq(0)");d(p,g,e)&&(e.showBtn||(p.css("borderRadius",4),h.css("width","100%").find(".btn:eq(0)").hide()),p.removeClass("disabled").prop("disabled",A).attr("autocomplete","off"),g.css(e.listStyle),e.inputBgColor||(e.inputBgColor=p.css("backgroundColor")),p.on("keydown",function(t){var a,s;if(g.is(":visible")){if(a=g.find("."+e.listHoverCSS),s="",u(g,e),t.keyCode===e.keyDown){if(a.length?a.next().length?s=n(a.next().mouseover()):e.autoSelect&&o(p,"").val(i(p)):s=n(g.find("tbody tr:first").mouseover()),l(p,g,e),!e.autoSelect)return}else if(t.keyCode===e.keyUp){if(a.length?a.prev().length?s=n(a.prev().mouseover()):e.autoSelect&&o(p,"").val(i(p)):s=n(g.find("tbody tr:last").mouseover()),l(p,g,e),!e.autoSelect)return}else t.keyCode===e.keyEnter?(s=n(a),g.hide()):o(p,"");r(p,s,e)}else o(p,"")}).on("compositionstart",function(t){m=D}).on("compositionend",function(t){m=A}).on("keyup input paste",function(n){var o;n.keyCode&&s(p,e),~t.inArray(n.keyCode,[e.keyDown,e.keyUp,e.keyEnter])?p.val(p.val()):(clearTimeout(c),c=setTimeout(function(){m||(o=p.val(),t.trim(o)&&o===i(p)||(i(p,o),e.multiWord&&(o=o.split(e.separator).reverse()[0]),(o.length||e.allowNoKeyword)&&e.fnGetData(t.trim(o),p,v,e)))},e.delay||300))}).on("focus",function(){a(p,g,e)}).on("blur",function(){f||g.css("display","")}).on("click",function(){var n=p.val();if(t.trim(n)&&n===i(p)&&g.find("table tr").length)return g.show();g.is(":visible")||(e.multiWord&&(n=n.split(e.separator).reverse()[0]),(n.length||e.allowNoKeyword)&&e.fnGetData(t.trim(n),p,v,e))}),h.find(".btn:eq(0)").attr("data-toggle","").click(function(){var t="none";return g.css("display")===t&&(t="block",e.url?(p.click().focus(),g.find("tr").length||(t="none")):v(p,e.data,e)),g.css("display",t),A}),g.mouseenter(function(){f=1,p.blur()}).mouseleave(function(){f=0,p.focus()}).on("mouseenter","tbody tr",function(){return u(g,e),t(this).addClass(e.listHoverCSS),A}).on("mousedown","tbody tr",function(){var o=n(t(this));r(p,o,e),i(p,o.key),s(p,e),g.hide()}),y.length&&(y.click(function(){o(p,"").val(""),s(p,e)}),h.mouseenter(function(){p.prop("disabled")||y.show()}).mouseleave(function(){y.hide()})))})},show:function(){return this.each(function(){t(this).click()})},hide:function(){return this.each(function(){t(this).parent().find("ul:eq(0)").css("display","")})},disable:function(){return this.each(function(){t(this).attr("disabled",D).parent().find(".btn:eq(0)").prop("disabled",D)})},enable:function(){return this.each(function(){t(this).attr("disabled",A).parent().find(".btn:eq(0)").prop("disabled",A)})},destroy:function(){return this.each(function(){t(this).off().removeData(j).removeAttr("style").parent().find(".btn:eq(0)").off().show().attr("data-toggle","dropdown").prop("disabled",A).next().css("display","").off()})},version:function(){return"0.1.21"}};t.fn[j]=function(e){if("string"==typeof e&&T[e]){var n=D;return this.each(function(){if(!t(this).data(j))return n=A}),n||"init"===e||"version"===e?T[e].apply(this,[].slice.call(arguments,1)):this}return T.init.apply(this,arguments)}});
//# sourceMappingURL=bootstrap-suggest.min.js.map